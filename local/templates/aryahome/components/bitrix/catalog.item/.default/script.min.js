function formtobasket(a){cleanFormToBasket();var t=$(a).parents(".item").first(),e=$(t).attr("data-id"),l=$(t).attr("data-name"),n=$(t).attr("data-name-code"),d=$(t).attr("data-color"),i=$(t).attr("data-preview"),a=$(t).attr("data-size-code"),t=$(t).attr("data-size"),c=$(".formtobasket.pre-accept");c.find(".product-title").html(l),document.querySelector('[data-type="item:color"]').append(BX.create("DIV",{props:{className:"name text-gray col-12 mb-2"},children:[BX.create("DIV",{props:{className:"row"},children:[BX.create("DIV",{html:"Цвет:"})]})]}),BX.create("DIV",{props:{className:"value w-100 mb-2"},children:[BX.create("DIV",{props:{className:"w-100 d-flex flex-wrap"},html:'<a href="#" onclick="colorActivated(this); return false" class="d-inline-block position-relative active" data-name="'+l+'" data-name-code="'+n+'" data-color="'+d+'" data-id="'+e+'"><img width="56px" height="56px" src="'+i+'" loading="lazy" title="'+d+'"></a>'})]})),$.ajax({url:"/api/CIBlockElement.GetList.Color.php",type:"POST",data:{action:"CIBlockElement::GetList.Color",name:l,namecode:n,sizecode:a,size:t},success:function(a){a=JSON.parse(a);var r="",s="";a.products.forEach(function(a,t,e){var i=a.TSVET,c=a.PREVIEW_PICTURE,o=(a.RAZMER,a.ID);null!=a.TSVET&&i!=s&&(d!=i&&(r+='<a href="#" onclick="colorActivated(this); return false" class="d-inline-block position-relative" data-name="'+l+'" data-name-code="'+n+'" data-color="'+i+'" data-id="'+o+'"><img width="56px" height="56px" src="'+c+'" loading="lazy" title="'+i+'"></a>'),s=i)}),""!=r&&c.find(".color .value div").append(r)}}),CIBlockItemGetListSize(e,l,n,d,a,t),c.fadeIn()}function CIBlockItemGetListSize(a,t,e,i,c,s){var l=$(".formtobasket.pre-accept"),o=document.querySelector('[data-type="item:size"]');0!=Object.keys(s).length&&o.append(BX.create("DIV",{props:{className:"name text-gray col-12 mb-md-3"},children:[BX.create("DIV",{props:{className:"row"},children:[BX.create("DIV",{html:"Размер:"})]})]}),BX.create("DIV",{props:{className:"value w-100 mb-md-3"},children:[BX.create("DIV",{props:{className:"w-100 d-flex flex-wrap"},html:'<a href="" onclick="sizeActivated(this); return false" class="active position-relative mb-1" data-id="'+a+'"><span class="d-block bg-graylight text-gold px-2 py-2">'+s+"</span></a>"})]})),$.ajax({url:"/api/CIBlockElement.GetList.Size.php",type:"POST",data:{action:"CIBlockElement::GetList.Size",name:t,namecode:e,color:i},success:function(a){a=JSON.parse(a);var o="",r="";a.products.forEach(function(a,t,e){var i=a.RAZMER,c=a.ID;null!=a.RAZMER&&i!=r&&(s!=i&&(o+='<a href="" onclick="sizeActivated(this); return false" class="position-relative mb-1" data-id="'+c+'"><span class="d-block bg-graylight text-gold px-2 py-2">'+i+"</span></a>"),r=i)}),""!=o&&l.find(".size .value div").append(o)}})}function colorActivated(a){var t=$(a).attr("data-name"),e=$(a).attr("data-name-code"),i=$(a).attr("data-color"),c=$('[data-type="item:props"]');$.ajax({url:"/api/CIBlockElement.GetList.Size.php",type:"POST",data:{action:"CIBlockElement::GetList.Size",name:t,namecode:e,color:i},success:function(a){a=JSON.parse(a);var o="",r="";a.products.forEach(function(a,t,e){var i=a.RAZMER,c=a.ID;null==a.RAZMER||i!=r&&(o+="0 "==t?'<a href="" onclick="sizeActivated(this); return false" class="position-relative active" data-id="'+c+'"><span class="d-block bg-graylight text-gold px-2 py-2">'+i+"</span></a>":'<a href="" onclick="sizeActivated(this); return false" class="position-relative" data-id="'+c+'"><span class="d-block bg-graylight text-gold px-2 py-2">'+i+"</span></a>",r=i)}),""==o?c.find(".size").html(""):c.find(".size .value div").html(o)}}),$(a).parents().first(".color").find(".active").removeClass("active"),$(a).addClass("active")}function sizeActivated(a){$(a).parents().first(".size").find(".active").removeClass("active"),$(a).addClass("active")}function formtofavorite(a){var t=$(a).parents(".item").attr("data-name"),e=$(a).parents(".item").attr("data-id"),i=$(a).parents(".item").attr("data-price");$(".overlay.formtofavorite").fadeIn(),$(a).hasClass("active")?($(a).removeClass("active"),$(".overlay.formtofavorite .product-title").html("Товар “"+t+"” убран из вашего списка избранных товаров")):($(a).addClass("active"),$.ajax({url:"/api/CSaleBasket.Add.php",type:"POST",data:{action:"CSaleBasket::Add:Delay",price:i,id:e},success:function(a){console.log("Товар успешно добавлен в ваш список избранных товаров!"),$(".overlay.formtofavorite .product-title").html("Товар “"+t+"” добавлен в ваш список избранных товаров")}}))}function Add2BasketByProductID(a,t){var e=$(".formtobasket.pre-accept"),i=$(a).parents(".element").first().find(".product-title").html(),c=$(a).parents(".element").first().find(".size .value .active").attr("data-id"),o=$(a).parents(".item").attr("data-price");null==c&&(c=$(a).parents(".element").first().find(".color .value .active").attr("data-id")),null==c&&(c=$(a).parents(".element").first().attr("data-id")),null==t&&(t=1),$.ajax({url:"/api/Add2BasketByProductID.php",type:"POST",data:{action:"Add2BasketByProductID",amount:t,id:c},success:function(a){console.log(a),dataLayer.push({event:"addToCart",ecommerce:{currencyCode:"RUB",add:{products:[{name:i,id:c,price:o,quantity:t}]}}}),ym(28747751,"reachGoal","cart"),console.log("Товар успешно добавлен в корзину!"),checkBasketItems()}}),e.fadeOut()}function AjaxCatalogElement(a){var a=$(a).parents(".item").first(),a=$(a).attr("data-id"),t=$(".overlay.quickview");BX.ajax({url:"/api/catalog.element.php",data:{ajax:"Y",id:a},method:"POST",dataType:"html",timeout:30,async:!0,processData:!0,scriptsRunFirst:!1,emulateOnload:!0,start:!0,cache:!1,onsuccess:function(a){t.find(".catalog").html(a)},onfailure:function(){}}),t.fadeIn()}function UpdateParamAjaxCatalogElement(a){var a=$(a).attr("data-id"),t=$(".overlay.quickview");BX.ajax({url:"/api/catalog.element.php",data:{ajax:"Y",id:a},method:"POST",dataType:"html",timeout:30,async:!0,processData:!0,scriptsRunFirst:!1,emulateOnload:!0,start:!0,cache:!1,onsuccess:function(a){t.find(".catalog").html(a)},onfailure:function(){}})}function closeQuickview(a){closeModal(a),$(a).parents(".catalog").first().html("")}$(document).ready(function(){$('*[data-modal="formtobasket-accept"]').on("click",function(){Add2BasketByProductID(this)})});